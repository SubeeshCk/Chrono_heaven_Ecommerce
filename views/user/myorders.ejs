<%- include('../layouts/user/product-header') %>

<style>
  /* Pagination Styling */
.pagination-container {
  display: flex;
  justify-content: center;
  margin-top: 2rem;
  margin-bottom: 2rem;
}

.pagination {
  display: flex;
  list-style: none;
  padding: 0;
  margin: 0;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.pagination li {
  margin: 0;
}

.pagination li a,
.pagination li span {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.75rem 1rem;
  min-width: 40px;
  background-color: white;
  color: #333;
  text-decoration: none;
  border: 1px solid #dee2e6;
  margin-left: -1px;
  transition: all 0.2s ease-in-out;
}

.pagination li.active a {
  background-color: #B9A273;
  color: white;
  border-color: #B9A273;
}

.pagination li a:hover:not(.active) {
  background-color: #f8f9fa;
  color: #B9A273;
}

.pagination li.disabled span {
  background-color: #f8f9fa;
  color: #6c757d;
  cursor: not-allowed;
}

.pagination li:first-child a,
.pagination li:first-child span {
  border-top-left-radius: 8px;
  border-bottom-left-radius: 8px;
}

.pagination li:last-child a,
.pagination li:last-child span {
  border-top-right-radius: 8px;
  border-bottom-right-radius: 8px;
}

/* Add this to your responsive styles */
@media (max-width: 576px) {
  .pagination li a,
  .pagination li span {
    padding: 0.5rem 0.75rem;
    min-width: 35px;
  }
}
      /* Container Styling */
      .path {
    display: flex;
    flex-direction: column;
    align-items: start;
    padding: 25px;
    background-color: #f9f9f9;
    border-radius: 8px;
    width: 300px; /* Increased width */
    font-family: Arial, sans-serif;
    margin-right: auto;
    margin-top: 10px;
    margin-bottom: 50px;
    height: 500px;
  }

  /* Link Styling */
  .path a {
    color: #333;
    text-decoration: none;
    font-size: 20px; /* Increased font size */
    font-weight: 300;
    padding: 12px 0; /* Slightly larger padding */
    transition: color 0.3s ease;
  }

  /* Hover and Active Link */
  .path a:hover {
    color: #007bff;
  }
  .path a[style*="color: red;"] {
    color: #dc3545;
  }

  /* Separator Line Styling */
  .path .separator {
    width: 100%;
    height: 1px;
    background-color: #e0e0e0;
    margin: 6px 0;
  }

  .checkout_form_input input[type="date"] {
    cursor: pointer;
  }

  .gender-inputs input[type="radio"] {
    cursor: pointer;
  }

  .align-right-btn {
    float: right;
  }

  .breadcrumb__links a {
    margin-right: 5px;
    text-decoration: none;
    color: #000;
  }

  .breadcrumb__links a:hover {
    color: red;
  }

  .order-item img {
    max-width: 100%;
    height: auto;
  }

  .status-label {
    color: #fff;
    height: 45%;
    width: 60%;
    padding: 5px;
    border-radius: 3px;
    font-weight: bold;
    display: inline-block;
    display: flex;
    justify-content: center;
  }

  .paymentStatus-label.true{
    background-color: #198754;
    color: #fff;
    width: 20%;
    padding: 5px;
    border-radius: 3px;
    font-weight: bold;
    display: inline-block;
    display: flex;
    justify-content: center;
  }

  .paymentStatus-label.false{
    background-color: #ffc107;
    color: #333;
    width: 20%;
    padding: 5px;
    border-radius: 3px;
    font-weight: bold;
    display: inline-block;
    display: flex;
    justify-content: center;
  }

  .status-label.pending {
    background-color: #ffc107;
    color: #333;
  }

  .status-label.confirmed {
    background-color: #0d6efd;
    color: #fff;
  }

  .status-label.shipped,
  .status-label.delivered {
    background-color: #198754;
    color: #fff;
  }

  .status-label.cancelled,
  .status-label.returned {
    background-color: #dc3545;
    color: #fff;
  }

  .status-label.returnrequestcancelled {
      background-color: #dc3545;
      color: #fff;
    }

  .status-label.returnrequested{
    background-color: #dc6435;
    color: #fff;
  }
  .order-summary {
    background-color: #f8f9fa;
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 5px;
  }

  .product-list {
    margin-top: 15px;
  }

  .product-item {
    border-bottom: 1px solid #dee2e6;
    padding: 10px 0;
  }

  .product-item:last-child {
    border-bottom: none;
  }

  .product-images {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
  }

  .product-images img {
    max-width: 100px;
    height: auto;
    object-fit: cover;
    border-radius: 4px;
  }

  .status-badge {
      padding: 5px 10px;
      border-radius: 4px;
      font-weight: 500;
      text-transform: capitalize;
    }
    
</style>
</head>
<body>

<!-- Breadcrumb Begin -->
<div class="container">
  <div class="bread-crumb flex-w  p-r-15 p-t-30 p-lr-0-lg">
    <a href="/" class="stext-109 cl8 hov-cl1 trans-04">
      Home
      <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
    </a>

    <a href="/user-profile" class="stext-109 cl8 hov-cl1 trans-04">
      User profile
      <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
    </a>

    <a href="/user-profile/myorders" class="stext-109 cl8 hov-cl1 trans-04">
      My orders
      <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
    </a>
    
  </div>
</div>
<!-- Breadcrumb End -->

<!-- Personal info Section Begin -->
<section class="checkout spad">
  <div class="container">
    <form action="#" class="checkout__form">
      <div class="row d-flex justify-content-end">
        <div class="path p-b-50">
          <div class="l">
            <a href="/user-profile">Personal Information</a>
          </div>
          <div class="separator"></div>
          <div>
            <a href="/user-profile/myorders" style="color: #dc3545;">My Orders</a>
          </div>
          <div class="separator"></div>
          <div>
            <a href="/user-profile/address">Address</a>
          </div>
          <div class="separator"></div>
          <div>
            <a href="/Wallet">Wallet</a>
          </div>
          <div class="separator"></div>
          <div>
            <a href="/user-profile/change-password" >Change Password</a>
          </div>
          <div class="separator"></div>
          <div>
            <a href="/refferal">Referral</a>
          </div>
          <div class="separator"></div>
        </div>
        
      <!-- Personal Information and Orders Content -->
      <div class="col-lg-8 " style="background-color: #f9f9f9; padding: 40px; border-radius: 10px;margin-bottom: 50px;">
        <h5 class="d-flex justify-content-center" style="font-weight: bold;">Your Orders</h5>
        <br>
        <hr>
        <br>
        <div class="orders">
          <% if (orderData && orderData.length > 0) { %>
            <% orderData.forEach(order => { %>
              <div class="order-item border rounded p-3 mb-3">
                <div class="order-summary">
                  <div class="d-flex justify-content-between align-items-center">
                    <h5>Order <%= order._id.toString().slice(-6) %></h5>
                    <span class="status-badge status-label <%= order.orderStatus.toLowerCase() %>">
                      <%if ( order.orderStatus === "returnRequested"){ %>
                      Return request pending
                      <% } else if ( order.orderStatus === "returnRequestCancelled") {%>
                      Return request cancelled
                      <% }else{ %>
                      Order <%= order.orderStatus %>
                      <% } %>
                    </span>

                  </div>
                  <p><strong>Order Date:</strong> <%= order.orderDate.toLocaleDateString() %></p>
                  <p><strong>Total Amount:</strong> â‚¹<%= order.orderAmount.toFixed(2) %></p>
                  <% if (order.deliveryAddress) { %>
                    <p>
                      <strong>Delivery Address:</strong> 
                      <%= order.deliveryAddress.name %>,<%= order.deliveryAddress.address %>, 
                      <%= order.deliveryAddress.locality %>, <%= order.deliveryAddress.city %> - 
                      <%= order.deliveryAddress.pincode %>
                    </p>
                  <% } %>
                </div>
      
                <div class="product-list">
                  <h6>Products in this order:</h6>
                  <div class="product-images">
                    <% order.orderedItem.forEach(item => { %>
                      <img src="<%= '/adminAssets/uploads/product_images/' + item.productId.images[0] %>" 
                           alt="<%= item.productId.product_name %>"
                           title="<%= item.productId.product_name %>">
                    <% }); %>
                  </div>
      
                  <% order.orderedItem.forEach(item => { %>
                    <div class="product-item">
                      <div class="row align-items-center">
                        <div class="col-md-8">
                          <h6><%= item.productId.product_name %></h6>
                          <p class="mb-0">Quantity: <%= item.quantity %></p>
                        </div>
                      </div>
                    </div>
                  <% }); %>
                </div>
      
                <div class="mt-3">
                  <a href="/user-profile/myorders/orderDetails/?orderId=<%= order._id %>" 
                     class="btn btn-primary">View Order Details</a>
                </div>
              </div>
            <% }); %>
          <% } else { %>
            <div class="alert alert-warning" role="alert">
              No orders yet.
            </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
<% if (totalPages > 1) { %>
  <div class="pagination-container">
    <ul class="pagination">
      <% if (hasPrevPage) { %>
        <li>
          <a href="?page=<%= prevPage %>" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
      <% } else { %>
        <li class="disabled">
          <span aria-hidden="true">&laquo;</span>
        </li>
      <% } %>

      <% if (currentPage > 2) { %>
        <li><a href="?page=1">1</a></li>
        <% if (currentPage > 3) { %>
          <li class="disabled"><span>...</span></li>
        <% } %>
      <% } %>

      <% for (let i = Math.max(1, currentPage - 1); i <= Math.min(totalPages, currentPage + 1); i++) { %>
        <li class="<%= currentPage === i ? 'active' : '' %>">
          <a href="?page=<%= i %>"><%= i %></a>
        </li>
      <% } %>

      <% if (currentPage < totalPages - 1) { %>
        <% if (currentPage < totalPages - 2) { %>
          <li class="disabled"><span>...</span></li>
        <% } %>
        <li><a href="?page=<%= totalPages %>"><%= totalPages %></a></li>
      <% } %>

      <% if (hasNextPage) { %>
        <li>
          <a href="?page=<%= nextPage %>" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      <% } else { %>
        <li class="disabled">
          <span aria-hidden="true">&raquo;</span>
        </li>
      <% } %>
    </ul>
  </div>
<% } %>
</section>
<!-- Personal Info and Orders Section End -->

<%- include('../layouts/user/footer') %>

<!-- Include jQuery and Bootstrap JavaScript at the end of the body to ensure they are loaded after the DOM is ready -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Custom JavaScript to handle the modal trigger -->
<script>
  $(document).ready(function () {
    $('#changePasswordBtn').click(function () {
      $('#changePasswordModal').modal('show');
    });
  });
</script>
